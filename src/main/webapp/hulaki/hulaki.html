<body>
<link data-lift="head" rel="stylesheet" type='text/css' href="/classpath/fobo/bootstrap.css"/>
<link data-lift="head" rel="stylesheet" type='text/css' href="/classpath/fobo/bootstrap-responsive.css"/>
<link data-lift="head" rel="stylesheet" href="/classpath/fobo/font-awesome.css">

<div id="fobo-main" class="lift:surround?with=libo/default;at=content">
  <h2 class="alt">Hulaki</h2>

    <form data-lift="form.ajax">
    <div data-lift="HulakiController">
        <span id="hidden"></span>
    <table>
        <tr><td>Module</td><td>        <input name="requestid" type="text" style='width:60em'/>       </td></tr>
        <tr><td>HTTP Request   </td>
            <td>
                <input name="request" type="text" style='width:60em'/>
                <input class="btn btn-primary" name="processreq" type="submit" value="Process Request"/>

            </td></tr>
	    <tr><td>Response </td><td>         
			    <textarea id="response" name="response" style="width: 840px; height: 450px;">
				    <lift:comet type="JsonCometActor" name="Other">
				        <resp:message>json</resp:message>
		                    </lift:comet>
			    </textarea>       
	    </td></tr>
    </table>
    <input class="btn btn-primary" name="submit" type="submit" value="Go"/> <br /> <br />
    </div>
    </form>
</div>

<script id="jquery" src="/classpath/jquery.js" type="text/javascript">

    function formatJSON(oData) {
       var sIndent = 4; 
       if (arguments.length < 2) {
            var sIndent = "";
        }
        var sIndentStyle = "    ";
        var sDataType = RealTypeOf(oData);

        // open object
        if (sDataType == "array") {
            if (oData.length == 0) {
                return "[]";
            }
            var sHTML = "[";
        } else {
            var iCount = 0;
            $.each(oData, function() {
                iCount++;
                return;
            });
            if (iCount == 0) { // object is empty
                return "{}";
            }
            var sHTML = "{";
        }

        // loop through items
        var iCount = 0;
        $.each(oData, function(sKey, vValue) {
            if (iCount > 0) {
                sHTML += ",";
            }
            if (sDataType == "array") {
                sHTML += ("\n" + sIndent + sIndentStyle);
            } else {
                sHTML += ("\n" + sIndent + sIndentStyle + "\"" + sKey + "\"" + ": ");
            }

            // display relevant data type
            switch (RealTypeOf(vValue)) {
                case "array":
                case "object":
                    sHTML += FormatJSON(vValue, (sIndent + sIndentStyle));
                    break;
                case "boolean":
                case "number":
                    sHTML += vValue.toString();
                    break;
                case "null":
                    sHTML += "null";
                    break;
                case "string":
                    sHTML += ("\"" + vValue + "\"");
                    break;
                default:
                    sHTML += ("TYPEOF: " + typeof(vValue));
            }

            // loop
            iCount++;
        });

        // close object
        if (sDataType == "array") {
            sHTML += ("\n" + sIndent + "]");
        } else {
            sHTML += ("\n" + sIndent + "}");
        }

        // return
        return sHTML;
    };

    $('#response').on('change keyup paste', function() {
         format();
    });

    function format(){
        console.log("prayagupd")
        var j = formatJSON( $('#response').val() )
        $('#response').text = j
    });

</script>		    

</body>
